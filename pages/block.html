<!DOCTYPE html>
<html lang="cs">

<head>
  <meta charset="UTF-8">
  <title>Anatomie bloku a tÄ›Å¾by</title>
  <link rel="shortcut icon" href="https://btc-slovnik.cz/favicon.png">
  <link rel="stylesheet" href="../css/styles.css">
  <meta name="description"
        content="Popisuje strukturu bloku a obligatornÃ­ mincetvornÃ© transakce. DÃ¡le vysvÄ›tluje princip tÄ›Å¾by bitcoinu.">
  <meta name="keywords"
        content="bitcoin, block, blok, blockchain, tranasakce, bip 9, tÄ›Å¾ba, mining, difficulty, target, genesis, bip 34, OP_RETURN">
  <link rel="canonical" href="https://btc-slovnik.cz/pages/block.html">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>
  <header>
    <div class="h1">
      <h1><a href="https://btc-slovnik.cz/#block"><span style="color:#f7931a">BitcoinovÃ½</span> slovnÃ­Äek pro mÃ­rnÄ› pokroÄilÃ©</a>
      </h1>
    </div>
  </header>
  <div class="container2">
    <article>
      <header>
        <h2>Anatomie bloku</h2>
        <p class="header"><time datetime="2021-06-21">AktualizovÃ¡no: 21. 6. 2021</time></p>
      </header>
      <p class="just">K popisu anatomie bitcoinovÃ©ho bloku pouÅ¾ijeme blok obsahujÃ­cÃ­ transakci z dÃ­lu <a href="./transaction.html">anatomie transakce</a> s poÅ™adovÃ½m ÄÃ­slem <a href="./stuff/676274.txt">676274</a> a hashem 00000000000000000000706c7f21388b285414c4829ee3981398e0cac82e43e3. NÃ¡sleduje hexadecimÃ¡lnÃ­ reprezentace serializace hlaviÄky bloku: </p>
      <p class="raw"><span class="ver" onmouseover="biggerbox('ver')" onmouseout="backbox('ver')">00008020</span><span class="prevbl" onmouseover="biggerbox('prevbl')" onmouseout="backbox('prevbl')">94dbc3cc1db91c6a106f6fb55b6e99a0b80eccc84b6d0b000000000000000000</span><span class="merkle" onmouseover="biggerbox('merkle')" onmouseout="backbox('merkle')">6b63e7d1a32149535d3f429ff5f9e7d9b1b19326876faff54d19610d7923ae7d</span><span class="time" onmouseover="biggerbox('time')" onmouseout="backbox('time')">1ebc5c60</span><span class="bits" onmouseover="biggerbox('bits')" onmouseout="backbox('bits')">6fdf0c17</span><span class="nonce" onmouseover="biggerbox('nonce')" onmouseout="backbox('nonce')">4bf00ded</span></p>
      <div class="fig">
        <table>
          <thead>
            <tr>
              <th>barva</th>
              <th>hodnota</th>
              <th>vÃ½znam</th>
              <th>formÃ¡t</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="color">
                <div id="ver" class="ver"></div>
              </td>
              <td>20800000</td>
              <td>verze bloku</td>
              <td>4 bajty LE</td>
            </tr>
            <tr>
              <td class="color">
                <div id="prevbl" class="prevbl"></div>
              </td>
              <td>00&hellip;3db94</td>
              <td>hash pÅ™edchozÃ­ho bloku</td>
              <td>32 bajtÅ¯ LE</td>
            </tr>
            <tr>
              <td class="color">
                <div id="merkle" class="merkle"></div>
              </td>
              <td>d7ae2&hellip;6b</td>
              <td>merkle root&semi; koÅ™enovÃ½ hash Merkleho stromu transakcÃ­</td>
              <td>32 bajtÅ¯ LE</td>
            </tr>
            <tr>
              <td class="color">
                <div id="time" class="time"></div>
              </td>
              <td>605cbc1e</td>
              <td>ÄasovÃ© razÃ­tko (timestamp)</td>
              <td>4 bajty LE</td>
            </tr>
            <tr>
              <td class="color">
                <div id="bits" class="bits"></div>
              </td>
              <td>170cdf6f</td>
              <td>bits; stanovuje cÃ­l tÄ›Å¾by</td>
              <td>4 bajty LE</td>
            </tr>
            <tr>
              <td class="color">
                <div id="nonce" class="nonce"></div>
              </td>
              <td>ed0df04b</td>
              <td>nonce&semi; zmÄ›nou se dosahuje zmÄ›ny hashe, jinak nemÃ¡ vÃ½znam</td>
              <td>4 bajty LE</td>
            </tr>
          </tbody>
        </table>
      </div>
      <p class="just">Z verze, konkrÃ©tnÄ› prvnÃ­ch tÅ™Ã­ bitÅ¯ zleva (001), mÅ¯Å¾eme vyÄÃ­st signalizaci podle <a href="https://github.com/bitcoin/bips/blob/master/bip-0009.mediawiki">BIP 9</a>. PÅ™Ã­tomnost hashe pÅ™edchozÃ­ho bloku je jasnÃ¡, blok je tÃ­m &ndash; podobnÄ› jako oka Å™etÄ›zu &ndash; pevnÄ› spojen s pÅ™edchozÃ­m blokem. KoÅ™enovÃ½ hash Merkleho stromu transakcÃ­ zaruÄuje, Å¾e se zmÄ›na byÅ¥ jedinÃ©ho bajtu v jedinÃ© do bloku zahrnutÃ© tx projevÃ­ v koneÄnÃ©m dÅ¯sledku zmÄ›nou hashe hlaviÄky tohoto bloku. ÄŒasovÃ© razÃ­tko Å™Ã­kÃ¡, Å¾e k vytÄ›Å¾enÃ­ bloku doÅ¡lo 1616690206 sekund od 1/1/1970, tedy 25/3/2021 v 16:36:46 UTC. Tento Ãºdaj ovÅ¡em nemusÃ­ bÃ½t zcela pÅ™esnÃ½. Aby byl blok pÅ™ijat sÃ­tÃ­, musÃ­ bÃ½t ÄasovÃ© razÃ­tko vÄ›tÅ¡Ã­, neÅ¾ mediÃ¡n ÄasovÃ½ch razÃ­tek poslednÃ­ch 11 blokÅ¯ a menÅ¡Ã­ neÅ¾ o dvÄ› hodiny navÃ½Å¡enÃ½ mediÃ¡n aktuÃ¡lnÃ­ch ÄasÅ¯ uzlÅ¯, ke kterÃ½m je uzel pÅ™ipojen. Z pole bits si vypoÄteme target &ndash; prvnÃ­ bajt (zleva) je exponent, zbytek koeficient. ZÅ¯staneme&hyphen;li v hexa, bude target cdf6f &times; 100<sup>17&minus;3</sup>. <a href="https://www.online-python.com/cVBjGF2Y5Z">PorovnÃ¡me</a>, je&hyphen;li hash naÅ¡eho bloku menÅ¡Ã­ neÅ¾ vypoÄtenÃ½ target. PoslednÃ­ pole obsahuje nonci, kterÃ© se budeme vÄ›novat pozdÄ›ji. </p>
      <p class="just">Za hlaviÄkou nÃ¡sleduje LE varint s poÄtem transakcÃ­ v bloku a pak uÅ¾ serializace vÅ¡ech tÄ›chto transakcÃ­. PrvnÃ­ z nich je ovÅ¡em speciÃ¡lnÃ­, tzv. mincetvornÃ¡ (coinbase). Ta se oproti zbytku liÅ¡Ã­ tÃ­m, Å¾e nemÃ¡ Å¾Ã¡dnÃ½ skuteÄnÃ½ vstup, resp. technicky vzato mÃ¡ mincetvornÃ¡ transakce prÃ¡vÄ› jeden vstup &ndash; hash pÅ™edchozÃ­ transakce je 32 bajtÅ¯ nul, index vÃ½stupu je ffffffff, podpisovÃ½ skript musÃ­ bÃ½t v rozmezÃ­ 2 a 100 bajtÅ¯, a musÃ­ bÃ½t sÃ¡m o sobÄ› pravdivÃ½. PrÃ¡vÄ› sem umÃ­stil <a href="https://btc-slovnik.cz/#nakamoto">Satoshi</a> v <a href="https://btc-slovnik.cz/#genesis">genesis bloku</a> legendÃ¡rnÃ­ titulek TimesÅ¯, zatÃ­mco ve scriptSigu mincetvornÃ© transakce naÅ¡eho bloku si mÅ¯Å¾eme pÅ™eÄÃ­st zprÃ¡vu &bdquo;Mined by AntPool713&ldquo;. Od <a href="https://github.com/bitcoin/bips/blob/master/bip-0034.mediawiki">BIPu 34</a> se do podpisovÃ©ho skriptu mincetvornÃ© transakce dÃ¡vÃ¡ na prvnÃ­ mÃ­sto element s ÄÃ­slem bloku. TÃ­m je zajiÅ¡tÄ›no, aby bylo moÅ¾no odliÅ¡it jinak stÃ¡le stejnÃ© mincetvornÃ© transakce jejich unikÃ¡tnÃ­m hashem txid. Navzdory tomu, Å¾e neutrÃ¡cÃ­ Å¾Ã¡dnÃ© <a href="https://btc-slovnik.cz/#utxo">UTXO</a>, mÅ¯Å¾e si tÄ›Å¾aÅ™ na vÃ½stupu uzamknout odmÄ›nu (v dobÄ› psanÃ­) aÅ¾ 6,25 BTC plus souÄet poplatkÅ¯ vÅ¡ech zahrnutÃ½ch transakcÃ­. Pokud blok obsahuje segwitovou transakci, musÃ­ takÃ© obsahovat OP_RETURN vÃ½stup s koÅ™enem paralelnÃ­ho Merkleho stromu svÄ›dkÅ¯ (witness). ProtoÅ¾e podpisovÃ© skripty segwit transakcÃ­ jiÅ¾ nejsou souÄÃ¡stÃ­ vÃ½poÄtu hashe transakce, a jejich zmÄ›na by se tedy neprojevila zmÄ›nou koÅ™enovÃ©ho hashe Markleho stromu v hlaviÄce bloku (a protoÅ¾e strukturu hlaviÄky nelze zmÄ›nit <a href="https://btc-slovnik.cz/#sfork">soft-forkem</a>), jsou hashe svÄ›dkÅ¯ (witness) transakcÃ­ zahrnuty do hlavnÃ­ho Merkleho stromu (a tÃ­m i do hashe hlaviÄky bloku) prÃ¡vÄ› touto cestou. DÃ­ky tomu platÃ­, Å¾e zmÄ›na kterÃ©hokoliv bajtu kterÃ©koliv v bloku zahrnutÃ© transakce se nakonec projevÃ­ zmÄ›nou hashe bloku. </p>
      <p class="just"><em>Velikost</em> zahrnutÃ½ch transakcÃ­ v bloku nesmÃ­ pÅ™ekroÄit 4 miliony <a href="https://btc-slovnik.cz/#wu">WU</a>. Na druhou stranu vÅ¡ak nemusÃ­ blok obsahovat Å¾Ã¡dnou dalÅ¡Ã­ transakci, kromÄ› mincetvornÃ©. To se dÄ›lo zejmÃ©na v prvnÃ­ch mÄ›sÃ­cÃ­ch fungovÃ¡nÃ­ sÃ­tÄ›, nynÃ­ uÅ¾ jen zÅ™Ã­dka. </p>
    </article> 
    <article>
      <header>
        <h2 id="mining">Anatomie tÄ›Å¾by</h2>
        <p class="header"><time datetime="2021-06-07">AktualizovÃ¡no: 7. 6. 2021</time></p>
      </header>
      <p class="just">Tzv. tÄ›Å¾ba bitcoinu je zpÅ¯sob, kterÃ½m je vybÃ­rÃ¡n takovÃ½ pÅ™Ã­Å¡tÃ­ nÃ¡hodnÃ½ zÃ¡pisce do blockchainu, kterÃ½ bude mÃ­t ekonomickou incentivu nepokouÅ¡et se o podvodnÃ½ zÃ¡pis. Ãškolem takovÃ©ho uchazeÄe o zÃ¡pis pÅ™Ã­Å¡tÃ­ho bloku do blockchainu je z dosud nezaÅ™azenÃ½ch transakcÃ­ sestavit tzv. kandidÃ¡tskÃ½ blok a ten upravit do takovÃ© podoby, aby byl <a href="https://btc-slovnik.cz/#hash">hash</a> hlaviÄky tohoto bloku menÅ¡Ã­, neÅ¾ tzv. <a href="https://btc-slovnik.cz/#target">cÃ­l tÄ›Å¾by</a>, nebo&hyphen;li target. Ten byl v <a href="https://btc-slovnik.cz/#genesis">genesis bloku</a> nastaven na ffff &times; 100<sup>1d-3</sup>. Od tÃ© doby je jednou za 2016 blokÅ¯ (tzv. epocha obtÃ­Å¾nosti) pÅ™epoÄÃ­tÃ¡vÃ¡n tak, Å¾e se spoÄte <em>rozdÃ­l</em> ÄasovÃ©ho razÃ­tka poslednÃ­ho a prvnÃ­ho* bloku konÄÃ­cÃ­ epochy. Pokud je tento vypoÄtenÃ½ <em>rozdÃ­l</em> vÄ›tÅ¡Ã­ neÅ¾ osm tÃ½dnÅ¯, pouÅ¾ije se dÃ¡le hodnota osmi tÃ½dnÅ¯; pokud je vypoÄtenÃ½ <em>rozdÃ­l</em> menÅ¡Ã­ neÅ¾ 84 hodin, pouÅ¾ije se dÃ¡le hodnota 84 hodin. NovÃ½ cÃ­l &equals; pÅ™edchÃ¡zejÃ­cÃ­ cÃ­l &times; <em>rozdÃ­l</em> &divide; 2 tÃ½dny. TÃ­mto postupem se postupnÄ› doÅ¡lo i k cÃ­li vÃ½Å¡e popsanÃ©ho bloku (cdf6f &times; 100<sup>17-3</sup>). </p>
      <p class="just">JelikoÅ¾ vÃ½stup hashovacÃ­ funkce nelze pÅ™edvÃ­dat, je splnÄ›nÃ­ tÃ©to podmÃ­nky vÄ›cÃ­ nÃ¡hody. TÃ©to nÃ¡hodÄ› lze jÃ­t naproti jedinÄ› tÃ­m, Å¾e je zahashovÃ¡no a otestovÃ¡no co moÅ¾nÃ¡ nejvÃ­ce hlaviÄek bloku v co moÅ¾nÃ¡ nejkratÅ¡Ã­m Äase. K tomu prÃ¡vÄ› slouÅ¾Ã­ pole nazvanÃ© nonce. S rozsahem 4 bajty dÃ¡vÃ¡ bez zmÄ›ny zbytku hlaviÄky pÅ™es 4 miliardy moÅ¾nÃ½ hashÅ¯. ProtoÅ¾e hlaviÄka obsahuje takÃ© kaÅ¾dou vteÅ™inu mÄ›nÃ­cÃ­ se timestamp, lze dÃ­ky nonci testovat pÅ™es 4 miliardy hashÅ¯ kaÅ¾dou vteÅ™inu. TÄ›Å¾aÅ™i (tÄ›Å¾aÅ™skÃ© pooly) s vÃ½konem pÅ™es 4 miliardy hashÅ¯ za sekundu pak mohou paralelnÄ› testovat rÅ¯znÃ© kandidÃ¡tskÃ© bloky, liÅ¡Ã­cÃ­ se v poÅ™adÃ­ zahrnutÃ½ch transakcÃ­, ÄÃ­mÅ¾ je zase dosaÅ¾eno rÅ¯znÃ½ch koÅ™enÅ¯ merkle stromu transakcÃ­. </p>
      <p class="just">Jakkoliv je vytÄ›Å¾enÃ­ (najitÃ­ takovÃ© podoby hlaviÄky, kterÃ¡ zahashovÃ¡nÃ­m dÃ¡ relativnÄ› nÃ­zkÃ© ÄÃ­slo &ndash; cÃ­l tÄ›Å¾by) vÃ½poÄetnÄ› velmi nÃ¡roÄnÃ© &ndash; v dobÄ› psanÃ­ tohoto pojednÃ¡nÃ­ vypoÄÃ­tajÃ­ vÅ¡ichni tÄ›Å¾aÅ™i v sÃ­ti pÅ™es 170 miliard miliard hashÅ¯ za vteÅ™inu, aby jeden z nich objevil prÅ¯mÄ›rnÄ› jednou za 10 minut vyhovujÃ­cÃ­ hash &ndash; ovÄ›Å™enÃ­ celÃ©ho bloku je ve srovnÃ¡nÃ­ s tÃ­m aÅ¾ legraÄnÄ› jednoduchÃ© &ndash; za tÃ­mto ÃºÄelem staÄÃ­ provÃ©st pouhÃ© tisÃ­ce vÃ½poÄtÅ¯ hashe. TÃ­m je zajiÅ¡tÄ›na krajnÃ­ nevÃ½hodnost pokusÅ¯ o podvÃ¡dÄ›nÃ­ Äi poruÅ¡enÃ­ pravidel pÅ™i tÄ›Å¾bÄ›, neboÅ¥ to by bylo nesrovnatelnÄ› jednoduÅ¡eji a rychleji odhaleno. BudiÅ¾ tedy zdÅ¯raznÄ›no, Å¾e tÄ›Å¾aÅ™ musÃ­ zajistit, aby jeho blok vyhovoval vÅ¡em pravidlÅ¯m sÃ­tÄ› &ndash; nemÅ¯Å¾e si ve svÃ©m bloku napÅ™. zvÃ½Å¡it svou odmÄ›nu, protoÅ¾e takovÃ½ blok by byl okamÅ¾itÄ› zbytkem sÃ­tÄ› odmÃ­tnut a veÅ¡kerÃ¡ jeho prÃ¡ce na bloku by pÅ™iÅ¡la vniveÄ. </p>
      <p class="just">TÄ›Å¾ba tedy nenÃ­ Å¾Ã¡dnÃ© &bdquo;Å™eÅ¡enÃ­ komplexnÃ­ho matematickÃ©ho problÃ©mu&ldquo;, jako to tvrdÃ­ napÅ™. Dr. Sheldon Cooper v <a href="https://youtu.be/VOn9KOmy93w?t=151">TBBT S11E09</a>. Je to problÃ©m veskrze jednoduchÃ½ &ndash; tak dlouho hashovat hlaviÄku sestavenÃ©ho bloku s rÅ¯znÃ½mi noncemi, mÄ›nÃ­cÃ­m se ÄasovÃ½m razÃ­tkem a eventuelnÄ› i rÅ¯znÃ½mi ariantami stromu transakcÃ­, aÅ¾ nÃ¡m vyjde hash menÅ¡Ã­, neÅ¾ cÃ­l tÄ›Å¾by. </p>
      <div class="undernotes">
        <p class="note">* <em>toto je bug. SprÃ¡vnÄ› by se mÄ›l pouÅ¾Ã­t rozdÃ­l razÃ­tka poslednÃ­ho bloku konÄÃ­ÄÃ­ epochy a poslednÃ­ho bloku epochy pÅ™edchÃ¡zejÃ­cÃ­ tÃ© konÄÃ­cÃ­.</em></p>
      </div>
    </article>   
  </div>
  <footer>
    <div class="mail">
      <p>Sepsal <a class="warp" href="mailto:iwarp@pm.me">iWarp</a> (<a class="key" href="https://btc-slovnik.cz/pages/stuff/publickey.txt">ğŸ”‘ pubkey</a>).<br><a class="key" id="lit" href="https://btc-slovnik.cz/pages/literature.html">ğŸ“š OblÃ­benÃ¡ literatura</a> | <button onclick="dropDonate()" class="dropbtn key">âš¡ Donejt</button></p>
    </div>
    <div>
      <div class="tw">
        <a class="tw" href="https://twitter.com/btcslovnik"><img src="https://btc-slovnik.cz/img/twitter.svg" height="30" alt="twitter" /></a>
        <a class="license" href="https://btc-slovnik.cz/LICENSE"><img src="https://btc-slovnik.cz/img/public80x15.png" alt="CC0" /></a>
      </div>
    </div>
    <div id="donate" class="dropdown">
      <p>PÅ™ispÄ›j mi na pivo pÅ™es LNURL:</p>
      <img class="pointer" onclick="clipboardLNURL()" src="https://btc-slovnik.cz/img/lnurl.png" alt="LNURL" />
      <p onclick="clipboardLNURL()" class="lnurl pointer">LNURL1DP68GURN8GHJ7URP0YHXYARRWDKX7ANWD94JUCM69AKXUATJD3CZ7CTSDYHHVVF0D3H82UNV9UCS5SXUCE</p>
      <a class="invoice" rel=â€nofollowâ€ href="https://pay.btcslovnik.cz/tipjar/1">Nebo mi poÅ¡li tip pÅ™es mojÃ­ lightning brÃ¡nu.</a>
    </div>
  </footer>
  <script src="https://btc-slovnik.cz/pages/javascript.js"></script>
  <script src="https://btc-slovnik.cz/drop.js"></script>
</body>

</html>
