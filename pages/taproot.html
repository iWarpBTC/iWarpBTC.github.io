<!DOCTYPE html>
<html lang="cs">

<head>
  <meta charset="UTF-8">
  <title>Ãšvod do Taprootu</title>
  <link rel="shortcut icon" href="https://btc-slovnik.cz/favicon.png">
  <link rel="stylesheet" href="../css/styles.css">
  <link rel="stylesheet" href="../css/tooltip.css">
  <meta name="description"
        content="PÅ™ibliÅ¾uje vylepÅ¡enÃ­ bitcoinovÃ© sÃ­tÄ› pojmenovanÃ© Taproot.">
  <meta name="keywords"
        content="bitcoin, kryptografie, taproot, schnorr, podpis, bech32m">
  <link rel="canonical" href="https://btc-slovnik.cz/pages/taproot.html">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>
  <header>
    <div class="h1">
      <h1><a href="https://btc-slovnik.cz/#taproot"><span style="color:#f7931a">BitcoinovÃ½</span> slovnÃ­k nauÄnÃ½</a></h1>
    </div>
  </header>
  <div class="container2">
    <article>
      <header>
        <h2 id="taproot">Ãšvod do Taprootu (BIP 340/341/342)</h2>
        <p class="header"><time datetime="2021-06-24">AktualizovÃ¡no: 24. 6. 2021</time></p>
      </header>
      <p class="just">Dne 12/06/2021 byl vytÄ›Å¾en blok s poÅ™adovÃ½m ÄÃ­slem 687284, kterÃ½ byl 1815. blokem danÃ© epochy obtÃ­Å¾nosti signalizujÃ­cÃ­ pÅ™ipravenost na Taproot. TÃ­m se bitcoinovÃ¡ sÃ­Å¥ dohodla na tom, Å¾e poÄÃ­naje blokem 709632 (vytÄ›Å¾en 14/11/2021) doÅ¡lo k aktivaci <a href="https://btc-slovnik.cz/#sfork">soft&hyphen;forku</a> nazvanÃ©ho Taproot. </p>
      <p class="just">Toto vylepÅ¡enÃ­ pÅ™inÃ¡Å¡Ã­ novÃ½ typ vÃ½stupu pay&hyphen;to&hyphen;taproot (<span class="tooltip bottom animationTips blue" tool-tips="pay to taproot">p2tp</span>). Ten je podobnÃ½ prapÅ¯vodnÃ­mu <span class="tooltip bottom animationTips blue" tool-tips="pay to pubkey">p2pk</span>, jelikoÅ¾ neuzamykÃ¡ vÃ½stup ve prospÄ›ch nÄ›jakÃ©ho hashe (aÅ¥ uÅ¾ veÅ™ejnÃ©ho klÃ­Äe &ndash; <span class="tooltip bottom animationTips blue" tool-tips="pay to (witness) pubkey hash">p2(w)pkh</span>, nebo skriptu &ndash; <span class="tooltip bottom animationTips blue" tool-tips="pay to (witness) script hash">p2(w)sh</span>), nÃ½brÅ¾ ve prospÄ›ch pÅ™Ã­mo agregovanÃ©ho veÅ™ejnÃ©ho klÃ­Äe. TÃ­m se sice pÅ™ipravÃ­me o jednu vrstvu ochrany pÅ™ed velmi hypotetickÃ½m Ãºtokem pÅ™Ã­mo na problÃ©m diskrÃ©tnÃ­ho logaritmu v cyklickÃ© grupÄ›, zato ovÅ¡em uÅ¡etÅ™Ã­me na podpisovÃ½ch datech, neboÅ¥ jiÅ¾ nenÃ­ potÅ™eba k ovÄ›Å™enÃ­ podpisu pÅ™edklÃ¡dat "za hashem skrytÃ½" veÅ™ejnÃ½ klÃ­Ä. PozornÃ½ ÄtenÃ¡Å™ <a href="https://btc-slovnik.cz/pages/crypto.html#schnorr">anatomie Schnorrova podpisu</a>, kterÃ©Å¾to podpisovÃ© schÃ©ma bude novÄ› pro <span class="tooltip bottom animationTips blue" tool-tips="pay to taproot">p2tp</span> uÅ¾ito, by teÄ mÄ›l namÃ­tnout, Å¾e sice bude uÅ¡etÅ™eno na veÅ™ejnÃ©m klÃ­Äi, avÅ¡ak mÃ­sto dvojice 256bitovÃ½ch ÄÃ­sel (<em>r</em>, <em>s</em>) dostaneme podpis reprezentovanÃ½ bodem na kÅ™ivce a 256bitovÃ½m ÄÃ­slem (<em>R</em>, <em>s</em>), tedy si moc nepolepÅ¡Ã­me. Zde je vÅ¡ak zvoleno ponÄ›kud neortodoxnÃ­ Å™eÅ¡enÃ­ &ndash; novÃ© podpisovÃ© schÃ©ma bude pracovat pouze s body, jejichÅ¾ y&hyphen;ovÃ¡ souÅ™adnice bude sudÃ¡. V takovÃ©m pÅ™Ã­padÄ› bude postaÄovat k reprezentaci bodu R pouze x&hyphen;ovÃ¡ souÅ™adnice, ze kterÃ© je v takovÃ©m pÅ™Ã­padÄ› y&hyphen;ovÃ¡ jednoznaÄnÄ› dopoÄÃ­tatelnÃ¡. Podpis <span class="tooltip bottom animationTips blue" tool-tips="pay to taproot">p2tp</span> vÃ½stupu tedy bude v ideÃ¡lnÃ­m pÅ™Ã­padÄ› zabÃ­rat pouhÃ½ch 64 bajtÅ¯ (x&hyphen;ovÃ¡ souÅ™adnice bodu <em>R</em>, ÄÃ­slo <em>s</em>). </p>
      <p class="just">HlavnÃ­m pÅ™Ã­nosem SchnorrovÃ½ch podpisÅ¯ je vÅ¡ak linearita tohoto schÃ©matu, dÃ­ky kterÃ© je moÅ¾nÃ© sÄÃ­tat (agregovat) jak podpisy, tak i veÅ™ejnÃ© klÃ­Äe. I pÅ™esto, Å¾e patent (<a href="https://patents.google.com/patent/US4995082A/en">US4995082A</a>) na nÄ› vyprÅ¡el uÅ¾ pÅ™ed spuÅ¡tÄ›nÃ­m Bitcoinu, nebyly tehdy jeÅ¡tÄ› Schrorrovy podpisy natolik vyuÅ¾Ã­vÃ¡ny, proto Satoshi zvolil rozÅ¡Ã­Å™enÄ›jÅ¡Ã­ schÃ©ma <span class="tooltip bottom animationTips blue" tool-tips="elliptic curve digital signature algorithm">ECDSA</span>. A tak se Bitcoin jejich zavedenÃ­ doÄkÃ¡ tÃ©mÄ›Å™ aÅ¾ po 13 letech v rÃ¡mci Taprootu, kterÃ½ je na moÅ¾nosti pÅ™Ã­moÄarÃ©ho sÄÃ­tÃ¡nÃ­ klÃ­ÄÅ¯ a podpisÅ¯ zaloÅ¾en. </p>
      <p class="just">Tento novÃ½ vÃ½stup, oznaÄovanÃ½ takÃ© jako native segwit v1, bude pouÅ¾Ã­vat opravenou verzi kÃ³dovÃ¡nÃ­ adresy bech32<b>m</b>. U dosud pouÅ¾Ã­vanÃ©ho kÃ³dovÃ¡nÃ­ bech32 pro native segwit v0 (<span class="tooltip bottom animationTips blue" tool-tips="pay to witness pubkey hash">p2wpkh</span> a <span class="tooltip bottom animationTips blue" tool-tips="pay to witness script hash">p2wsh</span>) byl totiÅ¾ objeven neÄekanÃ½ bug &ndash; pokud bylo poslednÃ­m znakem adresy pÃ­smeno <em>p</em>, smazanÃ­ nebo naopak pÅ™idÃ¡nÃ­ pÃ­smena <em>q</em> pÅ™ed tohle poslednÃ­ <em>p</em> nemÃ¡ za nÃ¡sledek zneplatnÄ›nÃ­ kontrolnÃ­ho souÄtu. Toto je tedy zavedenÃ­m bech32m opraveno, aÄkoliv popsanÃ½ bug neohroÅ¾uje dosavadnÃ­ native segwit v0 adresy, neboÅ¥ jim je <a href="https://github.com/bitcoin/bips/blob/master/bip-0173.mediawiki">BIPem 173</a> stanovena fixnÃ­ dÃ©lka. </p>
      <p class="just">SamotnÃ½ Taproot je pak nadstavba <a href="https://github.com/bitcoin/bips/blob/master/bip-0114.mediawiki">vylepÅ¡enÃ­ <span class="tooltip bottom animationTips blue" tool-tips="merklized alternative script trees">MAST</span></a>. Jak napovÃ­dÃ¡ nÃ¡zev, toto vylepÅ¡enÃ­ rozdÄ›lÃ­ skript na nÄ›kolik rÅ¯znÃ½ch podmÃ­nek (alternativ) skriptu a nad tÄ›mi sestavÃ­ nÃ¡Å¡ starÃ½ znÃ¡mÃ½ Merkleho strom hashÅ¯. Pokud mÃ¡ k odemÄenÃ­ vÃ½stupu postaÄovat splnÄ›nÃ­ pouze nÄ›kterÃ½ch podmÃ­nek z vÃ­ce stanovenÃ½ch, nenÃ­ dÃ­ku <span class="tooltip bottom animationTips blue" tool-tips="merklized alternative script trees">MASTu</span> potÅ™eba odhalovat a zatÄ›Å¾ovat blockchain tÄ›mi nesplnÄ›nÃ½mi, ty budou v odemykacÃ­m skriptu reprezentovÃ¡ny pouze svÃ½mi hashi, resp. hashi celÃ½ch vÄ›tvÃ­. DÃ­ky Taprootu vÅ¡ak navÃ­c mÅ¯Å¾eme vybrat preferovanÃ½ zpÅ¯sob odemÄenÃ­ skriptu, kupÅ™Ã­kladu multisig 2 ze 2, kterÃ½ dÃ­ky Schnorrovi agregujeme do jedinÃ©ho veÅ™ejnÃ©ho klÃ­Äe (Å™Ã­kejme mu vnitÅ™nÃ­ klÃ­Ä). PÅ™Ã­padnÃ© ostatnÃ­ zpÅ¯soby odemÄenÃ­ &ndash; napÅ™. opatÅ™enÃ© spoustou rÅ¯znÃ½ch podmÃ­nek, Äi ÄasovÃ½ch zÃ¡mkÅ¯ pÅ™i poskytnutÃ­ pouze jednoho podpisu &ndash; budou i nadÃ¡le tvoÅ™it Merkleho strom, jehoÅ¾ koÅ™enovÃ½ hash bude zkombinovÃ¡n s vnitÅ™nÃ­m klÃ­Äem, vÃ½sledkem ÄehoÅ¾ je finÃ¡lnÃ­ veÅ™ejnÃ½ klÃ­Ä celÃ©ho <span class="tooltip bottom animationTips blue" tool-tips="pay to taproot">p2tp</span> vÃ½stupu. Je&hyphen;li vÃ½stup odemÄen (agregovanÃ½m) podpisem odpovÃ­dajÃ­cÃ­mu vnitÅ™nÃ­mu klÃ­Äi, nenÃ­ moÅ¾nÃ© poznat, zda byl odemykanÃ½ vÃ½stup uzamÄen jednomu, Äi vÃ­ce veÅ™ejnÃ½m klÃ­ÄÅ¯m, ani zda existoval alternativnÃ­ zpÅ¯sob odemÄenÃ­ skriptem. V pÅ™Ã­padÄ› odemÄenÃ­ skriptem je pak i nadÃ¡le nutnÃ© vyjevit pouze ty splÅˆovanÃ© podmÃ­nky. </p>
      <p class="just">Co prozatÃ­m Taproot nepÅ™inÃ¡Å¡Ã­, je moÅ¾nost vytvoÅ™enÃ­ jednoho agregovanÃ©ho podpisu pro nÄ›kolik rÅ¯znÃ½ch vstupÅ¯ (cross&hyphen;input signature aggregation). I nadÃ¡le platÃ­, Å¾e kaÅ¾dÃ½ vstup transakce musÃ­ mÃ­t svÅ¯j vlastnÃ­ podpis. </p>
    </article>
  </div>
  <footer>
    <div class="mail">
      <p>Sepsal <a class="warp" href="mailto:iwarp@pm.me">iWarp</a> (<a class="key" href="https://btc-slovnik.cz/pages/stuff/publickey.txt">ğŸ”‘ pubkey</a>).<br><a class="key" id="lit" href="https://btc-slovnik.cz/pages/literature.html">ğŸ“š OblÃ­benÃ¡ literatura</a> | <button onclick="dropDonate()" class="dropbtn key">âš¡ Donejt</button></p>
    </div>
    <div>
      <div class="tw">
        <a class="tw" href="https://twitter.com/btcslovnik"><img src="https://btc-slovnik.cz/img/twitter.svg" height="30" alt="twitter" /></a>
        <a class="license" href="https://btc-slovnik.cz/LICENSE"><img src="https://btc-slovnik.cz/img/public80x15.png" alt="CC0" /></a>
      </div>
    </div>
    <div id="donate" class="dropdown">
      <p>PÅ™ispÄ›j mi na pivo pÅ™es LNURL:</p>
      <img class="pointer" onclick="clipboardLNURL()" src="https://btc-slovnik.cz/img/lnurl.png" alt="LNURL" />
      <p onclick="clipboardLNURL()" class="lnurl pointer">LNURL1DP68GURN8GHJ7URP0YHXYARRWDKX7ANWD94JUCM69AKXUATJD3CZ7CTSDYHHVVF0D3H82UNV9UCS5SXUCE</p>
      <a class="invoice" rel=â€nofollowâ€ href="https://pay.btcslovnik.cz/tipjar/1">Nebo mi poÅ¡li tip pÅ™es mojÃ­ lightning brÃ¡nu.</a>
    </div>
  </footer>
  <script src="https://btc-slovnik.cz/drop.js"></script>
</body>

</html>
